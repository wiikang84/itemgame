<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¬ë¡¯ë¨¸ì‹  - ItemGame</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/slot.css">
</head>
<body>
    <!-- í—¤ë” -->
    <header class="header">
        <div class="header-logo" onclick="location.href='index.html'" style="cursor:pointer">ITEM<span>GAME</span></div>
        <div class="header-chips">
            <div class="chip-icon">$</div>
            <div class="chip-balance" id="headerChips">0</div>
        </div>
        <nav class="header-nav">
            <button class="nav-btn" onclick="location.href='index.html'">ë¡œë¹„</button>
        </nav>
    </header>

    <!-- ë©”ì¸ -->
    <main class="container">
        <div class="slot-container">
            <!-- ìŠ¬ë¡¯ë¨¸ì‹  -->
            <div class="slot-machine">
                <div class="slot-title">ğŸ° MEGA SLOTS</div>

                <!-- ë¦´ ì˜ì—­ -->
                <div class="reels-container">
                    <div class="reels-grid">
                        <!-- JSë¡œ ìƒì„± -->
                    </div>
                </div>

                <!-- ê²°ê³¼ í‘œì‹œ -->
                <div class="result-display" id="slotResult">SPINì„ ëˆŒëŸ¬ ì‹œì‘í•˜ì„¸ìš”!</div>

                <!-- ì»¨íŠ¸ë¡¤ -->
                <div class="slot-controls">
                    <!-- ë² íŒ… -->
                    <div class="slot-bet-area">
                        <div class="bet-controls">
                            <button class="bet-btn" onclick="SlotMachine.decreaseBet()">âˆ’</button>
                            <span class="bet-label">BET</span>
                            <span class="bet-amount" id="betAmount">100</span>
                            <button class="bet-btn" onclick="SlotMachine.increaseBet()">+</button>
                        </div>
                        <div class="quick-bet-buttons">
                            <button class="quick-bet" data-bet="10" onclick="SlotMachine.setBet(10)">10</button>
                            <button class="quick-bet" data-bet="50" onclick="SlotMachine.setBet(50)">50</button>
                            <button class="quick-bet active" data-bet="100" onclick="SlotMachine.setBet(100)">100</button>
                            <button class="quick-bet" data-bet="500" onclick="SlotMachine.setBet(500)">500</button>
                            <button class="quick-bet" data-bet="1000" onclick="SlotMachine.setBet(1000)">MAX</button>
                        </div>
                    </div>

                    <!-- ìŠ¤í•€ ë²„íŠ¼ -->
                    <button class="spin-button" id="spinButton" onclick="SlotMachine.spin()">SPIN</button>

                    <!-- ìë™ ìŠ¤í•€ -->
                    <div class="auto-spin-controls">
                        <button class="auto-spin-toggle" id="autoSpinBtn" onclick="SlotMachine.toggleAutoSpin()">ğŸ”„ ìë™ ìŠ¤í•€</button>
                    </div>
                </div>
            </div>

            <!-- í˜ì´í…Œì´ë¸” -->
            <div class="paytable">
                <h3>ğŸ’° í˜ì´í…Œì´ë¸” (ë² íŒ… x ë°°ìˆ˜)</h3>
                <div class="paytable-grid" id="paytableGrid">
                    <!-- JSë¡œ ìƒì„± -->
                </div>
                <p class="text-dim text-center mt-2" style="font-size:0.8rem">
                    9ê°œ í˜ì´ë¼ì¸ | 3ê°œ ì´ìƒ ì—°ì† ë§¤ì¹­ ì‹œ ë‹¹ì²¨ | RTP ~96%
                </p>
            </div>
        </div>
    </main>

    <!-- ìŠ¹ë¦¬ ì˜¤ë²„ë ˆì´ -->
    <div class="win-overlay" id="winOverlay">
        <div class="win-text">
            WIN!
            <span class="amount">+0</span>
        </div>
    </div>

    <!-- í† ìŠ¤íŠ¸ -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="js/core/firebase-config.js"></script>
    <script src="js/core/chip-manager.js"></script>
    <script src="js/games/slot-machine.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            ChipManager.init();
            ChipManager.onBalanceChange(() => {
                document.getElementById('headerChips').textContent = ChipManager.formatBalance();
            });
            document.getElementById('headerChips').textContent = ChipManager.formatBalance();

            SlotMachine.init();
            _buildPaytable();
        });

        // í˜ì´í…Œì´ë¸” ìƒì„±
        function _buildPaytable() {
            const grid = document.getElementById('paytableGrid');
            if (!grid) return;
            grid.innerHTML = '';

            SlotMachine.SYMBOLS.forEach(sym => {
                const item = document.createElement('div');
                item.className = 'paytable-item';
                item.innerHTML = `
                    <span class="paytable-symbol">${sym.emoji}</span>
                    <span class="paytable-info">
                        ${sym.name}<br>
                        <span class="multiplier">x${sym.pay[0]}</span> /
                        <span class="multiplier">x${sym.pay[1]}</span> /
                        <span class="multiplier">x${sym.pay[2]}</span>
                    </span>
                `;
                grid.appendChild(item);
            });
        }

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && !SlotMachine.getIsSpinning()) {
                e.preventDefault();
                SlotMachine.spin();
            }
        });
    </script>
</body>
</html>
